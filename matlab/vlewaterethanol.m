function vaporfraction = vlewaterethanol(liquidfraction)
% Program currently only works for the ethanol output of ethanol/water VLE.

% VLE=[ liq eth, liq water, vap eth, vap water]
vle=[1.0000         0    1.0000         0
    0.9900    0.0100    0.9888    0.0112
    0.9800    0.0200    0.9780    0.0220
    0.9700    0.0300    0.9673    0.0327
    0.9600    0.0400    0.9570    0.0430
    0.9400    0.0600    0.9369    0.0631
    0.9200    0.0800    0.9178    0.0822
    0.9000    0.1000    0.8996    0.1004
    0.8500    0.1500    0.8575    0.1425
    0.8000    0.2000    0.8198    0.1802
    0.7500    0.2500    0.7858    0.2142
    0.7000    0.3000    0.7552    0.2448
    0.6500    0.3500    0.7274    0.2726
    0.6000    0.4000    0.7022    0.2978
    0.5500    0.4500    0.6790    0.3210
    0.5000    0.5000    0.6576    0.3424
    0.4500    0.5500    0.6376    0.3624
    0.4000    0.6000    0.6186    0.3814
    0.3500    0.6500    0.6000    0.4000
    0.3000    0.7000    0.5808    0.4192
    0.2500    0.7500    0.5598    0.4402
    0.2000    0.8000    0.5344    0.4656
    0.1500    0.8500    0.4996    0.5004
    0.1000    0.9000    0.4441    0.5559
    0.0800    0.9200    0.4101    0.5899
    0.0600    0.9400    0.3638    0.6362
    0.0400    0.9600    0.2967    0.7033
    0.0300    0.9700    0.2505    0.7495
    0.0200    0.9800    0.1911    0.8089
    0.0100    0.9900    0.1116    0.8884
         0    1.0000         0    1.0000];
x1=vle(:,1); x2=vle(:,2); y1=vle(:,3); y2=vle(:,4);

[fit1,gof1]=fit(x1,y1,'fourier8');

% figure(1)
% clf
% plot(fit1,x1,y1)
% hold on
% plot(xhold,yhold)
% title('VLE Ethanol')

vaporfraction=fit1(liquidfraction);

a0 =  -3.492e+09;
a1 =   5.316e+09;
b1 =   3.256e+09;
a2 =  -2.008e+09;
b2 =  -3.937e+09;
a3 =  -1.917e+08;
b3 =   2.454e+09;
a4 =   6.204e+08;
b4 =  -8.553e+08;
a5 =  -3.119e+08;
b5 =   1.295e+08;
a6 =   7.491e+07;
b6 =   1.178e+07;
a7 =  -8.135e+06;
b7 =   -6.93e+06;
a8 =   2.211e+05;
b8 =   6.771e+05;
w =       1.047;

x=liquidfraction;

vaporfraction2 = a0 + a1*cos(x*w) + b1*sin(x*w) + ...
               a2*cos(2*x*w) + b2*sin(2*x*w) + a3*cos(3*x*w) + b3*sin(3*x*w) + ...
               a4*cos(4*x*w) + b4*sin(4*x*w) + a5*cos(5*x*w) + b5*sin(5*x*w) + ...
               a6*cos(6*x*w) + b6*sin(6*x*w) + a7*cos(7*x*w) + b7*sin(7*x*w) + ...
               a8*cos(8*x*w) + b8*sin(8*x*w);

end